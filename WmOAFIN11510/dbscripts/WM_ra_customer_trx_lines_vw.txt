/*----------------------------------------------------------------------*/
--      Create View WM_RA_CUSTOMER_TRX_LINES_VW
/*----------------------------------------------------------------------*/

CREATE OR REPLACE VIEW WM_RA_CUSTOMER_TRX_LINES_VW ( CUSTOMER_TRX_LINE_ID, 
CUSTOMER_TRX_ID, LINK_TO_CUST_TRX_LINE_ID, LINK_TO_CUST_TRX_LINE, PREVIOUS_CUST_TRX_LINE_NUM, 
INITIAL_CUSTOMER_TRX_LINE_NUM, LINE_NUMBER, LINE_TYPE, DESCRIPTION, 
QUANTITY_ORDERED, QUANTITY_CREDITED, QUANTITY_INVOICED, UNIT_STANDARD_PRICE, 
UNIT_SELLING_PRICE, REVENUE_AMOUNT, EXTENDED_AMOUNT, AMOUNT_INCLUDES_TAX_FLAG, 
UOM_CODE, REASON_CODE, REASON_CODE_MEANING, ACCOUNTING_RULE_ID, 
ACCOUNTING_RULE_DURATION, ACCOUNTING_RULE_NAME, RULE_START_DATE, LAST_PERIOD_TO_CREDIT, 
INVENTORY_ITEM_ID, INVENTORY_ITEM, MEMO_LINE_ID, MEMO_LINE_NAME, 
TAX_PRECEDENCE, TAX_RATE, TAX_EXEMPT_FLAG, TAX_EXEMPT_NUMBER, 
TAX_EXEMPT_REASON_CODE, TAX_EXEMPT_REASON_CODE_MEANING, SALES_TAX_ID, SALES_TAX_CODE, 
LOCATION_SEGMENT_ID, VAT_TAX_ID, SALES_ORDER_SOURCE, SALES_ORDER, 
SALES_ORDER_REVISION, SALES_ORDER_LINE, SALES_ORDER_DATE, MOVEMENT_ID, 
DEFAULT_USSGL_TRANSACTION_CODE, DEFAULT_USSGL_TRX_CODE_CONTEXT, ATTRIBUTE_CATEGORY, ATTRIBUTE1, 
ATTRIBUTE2, ATTRIBUTE3, ATTRIBUTE4, ATTRIBUTE5, 
ATTRIBUTE6, ATTRIBUTE7, ATTRIBUTE8, ATTRIBUTE9, 
ATTRIBUTE10, ATTRIBUTE11, ATTRIBUTE12, ATTRIBUTE13, 
ATTRIBUTE14, ATTRIBUTE15, INTERFACE_LINE_CONTEXT, INTERFACE_LINE_ATTRIBUTE1, 
INTERFACE_LINE_ATTRIBUTE2, INTERFACE_LINE_ATTRIBUTE3, INTERFACE_LINE_ATTRIBUTE4, INTERFACE_LINE_ATTRIBUTE5, 
INTERFACE_LINE_ATTRIBUTE6, INTERFACE_LINE_ATTRIBUTE7, INTERFACE_LINE_ATTRIBUTE8, INTERFACE_LINE_ATTRIBUTE9, 
INTERFACE_LINE_ATTRIBUTE10, INTERFACE_LINE_ATTRIBUTE11, INTERFACE_LINE_ATTRIBUTE12, INTERFACE_LINE_ATTRIBUTE13, 
INTERFACE_LINE_ATTRIBUTE14, INTERFACE_LINE_ATTRIBUTE15, REFERENCE_LINE_CONTEXT, REFERENCE_LINE_ATTRIBUTE1, 
REFERENCE_LINE_ATTRIBUTE2, REFERENCE_LINE_ATTRIBUTE3, REFERENCE_LINE_ATTRIBUTE4, REFERENCE_LINE_ATTRIBUTE5, 
REFERENCE_LINE_ATTRIBUTE6, REFERENCE_LINE_ATTRIBUTE7, REFERENCE_LINE_ATTRIBUTE8, REFERENCE_LINE_ATTRIBUTE9, 
REFERENCE_LINE_ATTRIBUTE10, REFERENCE_LINE_ATTRIBUTE11, REFERENCE_LINE_ATTRIBUTE12, REFERENCE_LINE_ATTRIBUTE13, 
REFERENCE_LINE_ATTRIBUTE14, REFERENCE_LINE_ATTRIBUTE15, UOM_NAME, WAREHOUSE_ID, 
WAREHOUSE_NAME, ORGANIZATION_NAME, VAT_TAX_CODE, TRANSLATED_DESCRIPTION, 
TAX_ITEM_EXCEPTION, TAX_EXEMPTION, SALES_TAX_TO_POSTAL_CODE, SALES_TAX_FROM_POSTAL_CODE, 
TAX_ACCOUNT_NUMBER, LOCATION_SEGMENT_VALUE, LINK_TO_LINE_CONTEXT, LINK_TO_LINE_ATTRIBUTE1, 
LINK_TO_LINE_ATTRIBUTE2, LINK_TO_LINE_ATTRIBUTE3, LINK_TO_LINE_ATTRIBUTE4, LINK_TO_LINE_ATTRIBUTE5, 
LINK_TO_LINE_ATTRIBUTE6, LINK_TO_LINE_ATTRIBUTE7, LINK_TO_LINE_ATTRIBUTE8, LINK_TO_LINE_ATTRIBUTE9, 
LINK_TO_LINE_ATTRIBUTE10, LINK_TO_LINE_ATTRIBUTE11, LINK_TO_LINE_ATTRIBUTE12, LINK_TO_LINE_ATTRIBUTE13, 
LINK_TO_LINE_ATTRIBUTE14, LINK_TO_LINE_ATTRIBUTE15 ) AS SELECT  
CTL.CUSTOMER_TRX_LINE_ID ,  
CTL.CUSTOMER_TRX_ID ,  
CTL.LINK_TO_CUST_TRX_LINE_ID ,  
CTL_LINK.LINE_NUMBER LINK_TO_CUST_TRX_LINE,  
CTL_PREV.LINE_NUMBER PREVIOUS_CUST_TRX_LINE_NUM,  
NULL,  
--CTL_INI.LINE_NUMBER INITIAL_CUSTOMER_TRX_LINE_NUM,  
CTL.LINE_NUMBER ,  
CTL.LINE_TYPE ,  
CTL.DESCRIPTION ,  
CTL.QUANTITY_ORDERED ,  
CTL.QUANTITY_CREDITED,  
CTL.QUANTITY_INVOICED,  
CTL.UNIT_STANDARD_PRICE ,  
CTL.UNIT_SELLING_PRICE ,  
CTL.REVENUE_AMOUNT ,  
CTL.EXTENDED_AMOUNT ,  
NVL(CTL.AMOUNT_INCLUDES_TAX_FLAG,'DEFAULT') ,  
CTL.UOM_CODE ,  
CTL.REASON_CODE ,  
AL.MEANING REASON_CODE_MEANING,  
CTL.ACCOUNTING_RULE_ID ,  
CTL.ACCOUNTING_RULE_DURATION ,  
RR.NAME ACCOUNTING_RULE_NAME,  
CTL.RULE_START_DATE ,  
CTL.LAST_PERIOD_TO_CREDIT ,  
CTL.INVENTORY_ITEM_ID ,  
MSI.CONCATENATED_SEGMENTS  INVENTORY_ITEM,  
/*SEGMENT 1 IN TABLE MTL_SYSTEM_ITEMS */    CTL.MEMO_LINE_ID ,  
/* + MEMO_LINE_NAME*/  
T.NAME MEMO_LINE_NAME,  
CTL.TAX_PRECEDENCE ,  
CTL.TAX_RATE ,  
CTL.TAX_EXEMPT_FLAG ,  
CTL.TAX_EXEMPT_NUMBER ,  
CTL.TAX_EXEMPT_REASON_CODE ,  
AL_TAX_REASON.MEANING TAX_EXEMPT_REASON_CODE_MEANING,  
CTL.SALES_TAX_ID ,  
NULL SALES_TAX_CODE,  
CTL.LOCATION_SEGMENT_ID ,  
CTL.VAT_TAX_ID ,  
CTL.SALES_ORDER_SOURCE ,  
CTL.SALES_ORDER ,  
CTL.SALES_ORDER_REVISION ,  
CTL.SALES_ORDER_LINE ,  
CTL.SALES_ORDER_DATE ,  
CTL.MOVEMENT_ID ,  
/* MTL_MOVEMENT_STATISTICS*/    CTL.DEFAULT_USSGL_TRANSACTION_CODE ,  
CTL.DEFAULT_USSGL_TRX_CODE_CONTEXT ,  
CTL.ATTRIBUTE_CATEGORY,  
CTL.ATTRIBUTE1,  
CTL.ATTRIBUTE2,  
CTL.ATTRIBUTE3,  
CTL.ATTRIBUTE4,  
CTL.ATTRIBUTE5,  
CTL.ATTRIBUTE6,  
CTL.ATTRIBUTE7,  
CTL.ATTRIBUTE8,  
CTL.ATTRIBUTE9,  
CTL.ATTRIBUTE10,  
CTL.ATTRIBUTE11,  
CTL.ATTRIBUTE12,  
CTL.ATTRIBUTE13,  
CTL.ATTRIBUTE14,  
CTL.ATTRIBUTE15,  
CTL.INTERFACE_LINE_CONTEXT ,  
CTL.INTERFACE_LINE_ATTRIBUTE1,  
CTL.INTERFACE_LINE_ATTRIBUTE2,  
CTL.INTERFACE_LINE_ATTRIBUTE3,  
CTL.INTERFACE_LINE_ATTRIBUTE4,  
CTL.INTERFACE_LINE_ATTRIBUTE5,  
CTL.INTERFACE_LINE_ATTRIBUTE6,  
CTL.INTERFACE_LINE_ATTRIBUTE7,  
CTL.INTERFACE_LINE_ATTRIBUTE8,  
CTL.INTERFACE_LINE_ATTRIBUTE9,  
CTL.INTERFACE_LINE_ATTRIBUTE10,  
CTL.INTERFACE_LINE_ATTRIBUTE11,  
CTL.INTERFACE_LINE_ATTRIBUTE12,  
CTL.INTERFACE_LINE_ATTRIBUTE13,  
CTL.INTERFACE_LINE_ATTRIBUTE14,  
CTL.INTERFACE_LINE_ATTRIBUTE15,  
CTL_PREV.INTERFACE_LINE_CONTEXT ,  
CTL_PREV.INTERFACE_LINE_ATTRIBUTE1,  
CTL_PREV.INTERFACE_LINE_ATTRIBUTE2,  
CTL_PREV.INTERFACE_LINE_ATTRIBUTE3,  
CTL_PREV.INTERFACE_LINE_ATTRIBUTE4,  
CTL_PREV.INTERFACE_LINE_ATTRIBUTE5,  
CTL_PREV.INTERFACE_LINE_ATTRIBUTE6,  
CTL_PREV.INTERFACE_LINE_ATTRIBUTE7,  
CTL_PREV.INTERFACE_LINE_ATTRIBUTE8,  
CTL_PREV.INTERFACE_LINE_ATTRIBUTE9,  
CTL_PREV.INTERFACE_LINE_ATTRIBUTE10,  
CTL_PREV.INTERFACE_LINE_ATTRIBUTE11,  
CTL_PREV.INTERFACE_LINE_ATTRIBUTE12,  
CTL_PREV.INTERFACE_LINE_ATTRIBUTE13,  
CTL_PREV.INTERFACE_LINE_ATTRIBUTE14,  
CTL_PREV.INTERFACE_LINE_ATTRIBUTE15,  
UOM.UNIT_OF_MEASURE UOM_NAME,  
CTL.WAREHOUSE_ID ,  
HRORG.NAME WAREHOUSE_NAME ,  /* HR_ALL_ORGANIZATION_UNITS / AR_CUSTOMERS_V*/  
ORG.ORGANIZATION_NAME ,  
VAT.TAX_CODE ,  
CTL.TRANSLATED_DESCRIPTION,  
NULL TAX_ITEM_EXCEPTION,  
NULL TAX_EXEMPTION,  
NULL SALES_TAX_TO_POSTAL_CODE,  
NULL SALES_TAX_FROM_POSTAL_CODE,  
NULL TAX_ACCOUNT_NUMBER,  
NULL LOCATION_SEGMENT_VALUE,  
CTL_LINK.INTERFACE_LINE_CONTEXT ,  
CTL_LINK.INTERFACE_LINE_ATTRIBUTE1,  
CTL_LINK.INTERFACE_LINE_ATTRIBUTE2,  
CTL_LINK.INTERFACE_LINE_ATTRIBUTE3,  
CTL_LINK.INTERFACE_LINE_ATTRIBUTE4,  
CTL_LINK.INTERFACE_LINE_ATTRIBUTE5,  
CTL_LINK.INTERFACE_LINE_ATTRIBUTE6,  
CTL_LINK.INTERFACE_LINE_ATTRIBUTE7,  
CTL_LINK.INTERFACE_LINE_ATTRIBUTE8,  
CTL_LINK.INTERFACE_LINE_ATTRIBUTE9,  
CTL_LINK.INTERFACE_LINE_ATTRIBUTE10,  
CTL_LINK.INTERFACE_LINE_ATTRIBUTE11,  
CTL_LINK.INTERFACE_LINE_ATTRIBUTE12,  
CTL_LINK.INTERFACE_LINE_ATTRIBUTE13,  
CTL_LINK.INTERFACE_LINE_ATTRIBUTE14,  
CTL_LINK.INTERFACE_LINE_ATTRIBUTE15  
FROM  
AR_LOOKUPS AL_TAX,  
AR_LOOKUPS AL_CM_REASON,  
AR_LOOKUPS AL_INV_REASON,  
AR_LOOKUPS AL_TAX_REASON,  
RA_RULES RR,  
MTL_UNITS_OF_MEASURE UOM,  
--MTL_UNITS_OF_MEASURE UOM_PREV,  
RA_CUSTOMER_TRX_LINES_ALL CTL_PREV,  
RA_CUSTOMER_TRX_LINES_ALL CTL,  
RA_CUSTOMER_TRX_ALL CT,  
RA_CUST_TRX_TYPES_ALL CTT,  
AR_MEMO_LINES_ALL_TL T,  
AR_MEMO_LINES_ALL_B B,  
AR_VAT_TAX_ALL_B VAT,  
ORG_ORGANIZATION_DEFINITIONS ORG,  
RA_ADDRESSES_ALL RADD,  
RA_SITE_USES_ALL SITE ,  
--- CHANGE BEGINS  
RA_CUSTOMER_TRX_LINES_ALL CTL_LINK,  
--RA_CUSTOMER_TRX_LINES_ALL CTL_INI,  
AR_LOOKUPS AL,  
MTL_SYSTEM_ITEMS_B_KFV MSI,  
HR_ALL_ORGANIZATION_UNITS HRORG,  
MTL_UNITS_OF_MEASURE UOM_LINK  
--MTL_UNITS_OF_MEASURE UOM_INI  
WHERE  
CTL.CUSTOMER_TRX_ID = CT.CUSTOMER_TRX_ID AND  
CT.CUST_TRX_TYPE_ID = CTT.CUST_TRX_TYPE_ID AND  
CTT.TYPE NOT IN ('DEP', 'GUAR','BR') /* 19-APR-2000 J RAUTIAINEN BR IMPLEMENTATION */ AND  
CTL.PREVIOUS_CUSTOMER_TRX_LINE_ID = CTL_PREV.CUSTOMER_TRX_LINE_ID(+) AND  
CTL.UOM_CODE = UOM.UOM_CODE(+) AND  
--CTL_PREV.UOM_CODE = UOM_PREV.UOM_CODE(+) AND  
CTL.ACCOUNTING_RULE_ID = RR.RULE_ID(+) AND  
'TAX_CONTROL_FLAG' = AL_TAX.LOOKUP_TYPE(+) AND  
CTL.TAX_EXEMPT_FLAG = AL_TAX.LOOKUP_CODE(+) AND  
'INVOICING_REASON' = AL_INV_REASON.LOOKUP_TYPE(+) AND  
CTL.REASON_CODE = AL_INV_REASON.LOOKUP_CODE(+) AND  
'CREDIT_MEMO_REASON' = AL_CM_REASON.LOOKUP_TYPE(+) AND  
CTL.REASON_CODE = AL_CM_REASON.LOOKUP_CODE(+) AND  
'TAX_REASON' = AL_TAX_REASON.LOOKUP_TYPE(+) AND  
CTL.TAX_EXEMPT_REASON_CODE = AL_TAX_REASON.LOOKUP_CODE(+) AND  
CTL.MEMO_LINE_ID = B.MEMO_LINE_ID(+) AND  
CTL.VAT_TAX_ID = VAT.VAT_TAX_ID(+) AND  
CTL.WAREHOUSE_ID = ORG.ORGANIZATION_ID(+) AND  
CT.BILL_TO_SITE_USE_ID = SITE.SITE_USE_ID AND  
SITE.ADDRESS_ID = RADD.ADDRESS_ID AND  
--- CHANGE BEGINS  
CTL_LINK.CUSTOMER_TRX_LINE_ID (+) = CTL.LINK_TO_CUST_TRX_LINE_ID AND  
--CTL_INI.CUSTOMER_TRX_LINE_ID (+) = CTL.INITIAL_CUSTOMER_TRX_LINE_ID  AND  
AL.LOOKUP_CODE (+) = CTL.REASON_CODE AND  
MSI.INVENTORY_ITEM_ID (+) = CTL.INVENTORY_ITEM_ID AND  
MSI.ORGANIZATION_ID (+) = CTL.ORG_ID AND  
HRORG.ORGANIZATION_ID (+) = CTL.ORG_ID AND  
B.MEMO_LINE_ID = T.MEMO_LINE_ID (+) AND  
B.ORG_ID   =  T.ORG_ID  (+) AND  
CT.ORG_ID  = CTL.ORG_ID   AND  
CT.ORG_ID = VAT.ORG_ID  AND  
CTL.ORG_ID = B.ORG_ID (+) AND  
CTL.ORG_ID = CTT.ORG_ID (+) AND  
CTL_LINK.UOM_CODE = UOM_LINK.UOM_CODE(+) AND  
--CTL_INI.UOM_CODE = UOM_INI.UOM_CODE(+) AND  
CTL.LINE_TYPE = 'LINE'
/
